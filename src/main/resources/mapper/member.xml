<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.interviewgo.mapper.MemberMapper">
	<!-- 사용자 정보 입력 (임시) -->
	<!-- <insert id="insertMember" parameterType="com.interviewgo.dto.MemberDTO">
		insert into member(username,mb_password,mb_nickname,mb_pnumber,role,mb_date)	
		values(#{username},#{mb_password},#{mb_nickname},#{mb_pnumber},#{role},now())
	</insert> -->
	
	<!-- username 중복검사 -->
	<select id="countByUsername" parameterType="String" resultType="int">
        SELECT COUNT(*) 
        FROM member 
        WHERE username = #{username}
    </select>

	<!-- 회원가입 -->	
	<insert id="insertMember" parameterType="com.interviewgo.dto.MemberDTO">
        INSERT INTO member (
            username, 
            mb_password, 
            mb_nickname, 
            mb_pnumber, 
            role, 
            mb_date
        ) VALUES (
            #{username}, 
            #{mb_password}, 
            #{mb_nickname}, 
            #{mb_pnumber}, 
            #{role}, 
            NOW()
        )
    </insert>

	<!-- 사용자 정보 가져오기 (임시) -->
	<!-- <select id="getMember" parameterType="Long">
      SELECT * FROM member WHERE mb_uid = #{mb_uid}
	</select> -->
	
	<select id="getMemberById" parameterType="String">
		SELECT * FROM member WHERE username = #{username}
	</select>
	
	<!-- 사용자 정보 갱신 (임시) -->
	<update id="updateMember" parameterType="com.interviewgo.dto.MemberDTO">
		UPDATE member
		SET
			mb_password = #{mb_password}
			mb_nickname = #{mb_nickname}
			mb_pnumber = #{mb_punumber}
			mb_icon = #{mb_icon}
		WHERE mb_uid = #{mb_uid}
	</update>
	
	<!-- 비번찾기(회원인증) -->
	<select id="checkUserExists" parameterType="member" resultType="int">
        select count(*)
        from member
        where username = #{username}
          and mb_pnumber = #{mb_pnumber}
    </select>

	<!-- 임시비번 업데이트 -->
    <update id="updatePassword" parameterType="member" >
       update member
        set mb_password = #{mb_password}
        where username = #{username}
    </update>
</mapper>